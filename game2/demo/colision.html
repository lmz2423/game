<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="telephone=no" name="format-detection"/>
    <meta name="keywords" content=""/>
    <meta name="Description" content=""/>
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <title></title>
</head>
<body>
<canvas id="gameView" width="800" height="800"></canvas>
<script type="text/javascript" src="js/easeljs-0.8.1.min.js"></script>
<script type="text/javascript">
    (function (window) {

        var OBB = function (centerPoint, width, height, rotation) {

            this.centerPoint = centerPoint;
            this.extents = [width / 2, height / 2];
            this.axes = [new Vector2(Math.cos(rotation), Math.sin(rotation)), new Vector2(-1 * Math.sin(rotation), Math.cos(rotation))];

            this._width = width;
            this._height = height;
            this._rotation = rotation;
        };
        OBB.prototype = {
            getProjectionRadius: function (axis) {
                return this.extents[0] * Math.abs(axis.dot(this.axes[0])) + this.extents[1] * Math.abs(axis.dot(this.axes[1]));
            }
        };

        window.OBB = OBB;
    })(window);
    ( function (window) {
        var Vector2 = function (x, y) {
            this.x = x || 0;
            this.y = y || 0;
        };

        Vector2.prototype = {
            sub: function (v) {
                return new Vector2(this.x - v.x, this.y - v.y)
            },
            dot: function (v) {
                return this.x * v.x + this.y * v.y;
            }
        };
        window.Vector2 = Vector2;
    }(window));


        function detectorOBBvsOBB(rock, bike) {
            var RockRounds = rock.getBounds();
            var BikeRounds = bike.getBounds();
            var OBB1 = new OBB(new Vector2(RockRounds.x, RockRounds.y), RockRounds.width, RockRounds.height, rock.rotation * Math.PI / 180);
            var OBB2 = new OBB(new Vector2(BikeRounds.x, BikeRounds.y), BikeRounds.width, BikeRounds.height, bike.rotation * Math.PI / 180);
            var nv = OBB1.centerPoint.sub(OBB2.centerPoint);
            var axisA1 = OBB1.axes[0];
            if (OBB1.getProjectionRadius(axisA1) + OBB2.getProjectionRadius(axisA1) <= Math.abs(nv.dot(axisA1))) return false;
            var axisA2 = OBB1.axes[1];
            if (OBB1.getProjectionRadius(axisA2) + OBB2.getProjectionRadius(axisA2) <= Math.abs(nv.dot(axisA2))) return false;
            var axisB1 = OBB2.axes[0];
            if (OBB1.getProjectionRadius(axisB1) + OBB2.getProjectionRadius(axisB1) <= Math.abs(nv.dot(axisB1))) return false;
            var axisB2 = OBB2.axes[1];
            if (OBB1.getProjectionRadius(axisB2) + OBB2.getProjectionRadius(axisB2) <= Math.abs(nv.dot(axisB2))) return false;
            return true;
        }
    (function () {
        'use strict';
        var stage = new createjs.Stage("gameView");
        var shapeA = new createjs.Shape();
        var shapeB = new createjs.Shape();
        shapeA.graphics.beginFill("#ff0000").drawRect(280, 240, 100, 100);

        shapeB.graphics.beginFill("#00ff00").drawRect(280, 300, 100, 100);
        stage.addChild(shapeA, shapeB);
        createjs.Ticker.addEventListener('tick', tick);
        function tick() {
            shapeA.rotation = shapeA.rotation + 2;
            shapeB.rotation = shapeB.rotation + 3;
            stage.update();
        }
    }());
</script>
</body>
</html>